{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Yby Cluster Configuration",
  "description": "Configuration schema for Yby Clusters",
  "type": "object",
  "required": [
    "global"
  ],
  "properties": {
    "global": {
      "type": "object",
      "required": [
        "environment",
        "domainBase"
      ],
      "properties": {
        "environment": {
          "type": "string",
          "enum": [
            "dev",
            "staging",
            "prod"
          ],
          "description": "Deployment environment"
        },
        "domainBase": {
          "type": "string",
          "anyOf": [
            {
              "maxLength": 0
            },
            {
              "pattern": "^([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}$"
            }
          ],
          "description": "Base domain for the cluster (e.g., yby.example.com)"
        }
      }
    },
    "git": {
      "type": "object",
      "required": [
        "repoURL",
        "branch"
      ],
      "properties": {
        "repoURL": {
          "type": "string",
          "format": "uri"
        },
        "branch": {
          "type": "string",
          "default": "main"
        },
        "repoName": {
          "type": "string"
        }
      }
    },
    "discovery": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        },
        "scmProvider": {
          "type": "string",
          "enum": [
            "github",
            "gitlab"
          ],
          "default": "github"
        },
        "organization": {
          "type": "string"
        },
        "topic": {
          "type": "string"
        }
      }
    },
    "ingress": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        },
        "tls": {
          "type": "object",
          "properties": {
            "email": {
              "type": "string",
              "anyOf": [
                {
                  "maxLength": 0
                },
                {
                  "format": "email"
                }
              ]
            }
          }
        }
      }
    },
    "observability": {
      "type": "object",
      "properties": {
        "mode": {
          "type": "string",
          "enum": [
            "prometheus",
            "none"
          ],
          "default": "prometheus"
        }
      }
    },
    "kepler": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true
        }
      }
    },
    "storage": {
      "type": "object",
      "properties": {
        "minio": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false
            }
          }
        }
      }
    }
  }
}